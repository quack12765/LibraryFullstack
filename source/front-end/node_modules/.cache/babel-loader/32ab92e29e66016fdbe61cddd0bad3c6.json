{"remainingRequest":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\src\\views\\AdminMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\src\\views\\AdminMain.vue","mtime":1658481437062},{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBDb3B5czogW10sCiAgICAgIEJvcnJvd2luZzogW10sCiAgICAgIFNwYW5faW46IFtdLAogICAgICBTcGFuX291dDogW10sCiAgICAgIHNlbF9icmFuY2g6ICcnLAogICAgICBicmFuY2g6IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ0JyYW5jaCcpIHx8ICIiCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgdGhpcy4kaHR0cC5wb3N0KCcvYXBpL3NlYXJjaEJvb2svZ2V0Qm9ycm93aW5nQnlCcmFuY2gnLCB7CiAgICAgIGRhdGE6IHsKICAgICAgICBicmFuY2g6IHRoaXMuYnJhbmNoCiAgICAgIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICBfdGhpcy5Cb3Jyb3dpbmcgPSByZXMuZGF0YTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgfSk7CiAgICB0aGlzLiRodHRwLnBvc3QoJy9hcGkvbG9jYXRpb24vZ2V0SW5UcmFuc2ZlckJ5QnJhbmNoJywgewogICAgICBkYXRhOiB7CiAgICAgICAgYnJhbmNoOiB0aGlzLmJyYW5jaAogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgX3RoaXMuU3Bhbl9pbiA9IHJlcy5kYXRhOwogICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICBjb25zb2xlLmxvZyhlKTsKICAgIH0pOwogICAgdGhpcy4kaHR0cC5wb3N0KCcvYXBpL2xvY2F0aW9uL2dldE91dFRyYW5zZmVyQnlCcmFuY2gnLCB7CiAgICAgIGRhdGE6IHsKICAgICAgICBicmFuY2g6IHRoaXMuYnJhbmNoCiAgICAgIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICBfdGhpcy5TcGFuX291dCA9IHJlcy5kYXRhOwogICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkgewogICAgICBjb25zb2xlLmxvZyhlKTsKICAgIH0pOyAvLyBHZXQgZmlyc3QgJiBzZWNvbmQgbmF2IHNlbGVjdGlvbiBpbmZvcm1hdGlvbgoKICAgIHRoaXMuJGh0dHAucG9zdCgnL2FwaS9zZWFyY2hCb29rL2dldEFsbENvcHlCeUJyYW5jaCcsIHsKICAgICAgZGF0YTogewogICAgICAgIGxvY2F0aW9uOiB0aGlzLmJyYW5jaAogICAgICB9CiAgICB9KS50aGVuKGZ1bmN0aW9uIChjb3B5cykgewogICAgICBfdGhpcy5Db3B5cyA9IGNvcHlzLmRhdGE7CiAgICAgIGNvbnNvbGUubG9nKCJEQURBREEiLCBjb3B5cy5kYXRhKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBTZXRCcmFuY2g6IGZ1bmN0aW9uIFNldEJyYW5jaChiKSB7CiAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ0JyYW5jaCcsIGIpOwogICAgICB0aGlzLmJyYW5jaCA9IGI7CiAgICB9LAogICAgSGFuZGxlQmFja0NvcHk6IGZ1bmN0aW9uIEhhbmRsZUJhY2tDb3B5KENvcHlJbmZvKSB7CiAgICAgIHRoaXMuJGh0dHAucG9zdCgnL2FwaS9zZWFyY2hCb29rL2JhY2tDb3B5QnlBY2Nlc3Npb24nLCB7CiAgICAgICAgZGF0YTogQ29weUluZm8KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgYWxlcnQocmVzLmRhdGEuYWZmZWN0ZWRSb3dzID09PSAwID8gIuatuOmChOWkseaVlyEiIDogIuatuOmChOaIkOWKnyEiKTsKICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgfSk7CiAgICB9LAogICAgSGFuZGxlU3BhbjogZnVuY3Rpb24gSGFuZGxlU3BhbihhY2MpIHsKICAgICAgdGhpcy4kaHR0cC5wb3N0KCcvYXBpL3NlYXJjaEJvb2svc3BhbicsIHsKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBhY2Nlc3Npb25fbnVtYmVyOiBhY2MsCiAgICAgICAgICBsb2NhdGlvbjogdGhpcy5icmFuY2gKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGFsZXJ0KCLnp7vovYnmiJDlip/vvIEiKTsKICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgYnJhbmNoOiB7CiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoKSB7CiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"sources":["AdminMain.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,SAAA,EAAA,EAFA;AAGA,MAAA,OAAA,EAAA,EAHA;AAIA,MAAA,QAAA,EAAA,EAJA;AAKA,MAAA,UAAA,EAAA,EALA;AAMA,MAAA,MAAA,EAAA,cAAA,CAAA,OAAA,CAAA,QAAA,KAAA;AANA,KAAA;AAQA,GAVA;AAYA,EAAA,OAZA,qBAYA;AAAA;;AACA,SAAA,KAAA,CACA,IADA,CACA,sCADA,EACA;AACA,MAAA,IAAA,EAAA;AACA,QAAA,MAAA,EAAA,KAAA;AADA;AADA,KADA,EAMA,IANA,CAMA,UAAA,GAAA,EAAA;AACA,MAAA,KAAA,CAAA,SAAA,GAAA,GAAA,CAAA,IAAA;AACA,KARA,EASA,KATA,CASA,UAAA,CAAA,EAAA;AAAA,MAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AAAA,KATA;AAWA,SAAA,KAAA,CACA,IADA,CACA,qCADA,EACA;AACA,MAAA,IAAA,EAAA;AACA,QAAA,MAAA,EAAA,KAAA;AADA;AADA,KADA,EAMA,IANA,CAMA,UAAA,GAAA,EAAA;AACA,MAAA,KAAA,CAAA,OAAA,GAAA,GAAA,CAAA,IAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA,CAAA,IAAA;AACA,KATA,EAUA,KAVA,CAUA,UAAA,CAAA,EAAA;AAAA,MAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AAAA,KAVA;AAYA,SAAA,KAAA,CACA,IADA,CACA,sCADA,EACA;AACA,MAAA,IAAA,EAAA;AACA,QAAA,MAAA,EAAA,KAAA;AADA;AADA,KADA,EAMA,IANA,CAMA,UAAA,GAAA,EAAA;AACA,MAAA,KAAA,CAAA,QAAA,GAAA,GAAA,CAAA,IAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA,CAAA,IAAA;AACA,KATA,EAUA,KAVA,CAUA,UAAA,CAAA,EAAA;AAAA,MAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AAAA,KAVA,EAxBA,CAqCA;;AACA,SAAA,KAAA,CACA,IADA,CACA,oCADA,EACA;AACA,MAAA,IAAA,EAAA;AACA,QAAA,QAAA,EAAA,KAAA;AADA;AADA,KADA,EAMA,IANA,CAMA,UAAA,KAAA,EAAA;AACA,MAAA,KAAA,CAAA,KAAA,GAAA,KAAA,CAAA,IAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,QAAA,EAAA,KAAA,CAAA,IAAA;AACA,KATA,EAUA,KAVA,CAUA,UAAA,CAAA,EAAA;AAAA,MAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AAAA,KAVA;AAWA,GA7DA;AA+DA,EAAA,OAAA,EAAA;AACA,IAAA,SADA,qBACA,CADA,EACA;AACA,MAAA,cAAA,CAAA,OAAA,CAAA,QAAA,EAAA,CAAA;AACA,WAAA,MAAA,GAAA,CAAA;AACA,KAJA;AAMA,IAAA,cANA,0BAMA,QANA,EAMA;AACA,WAAA,KAAA,CACA,IADA,CACA,qCADA,EACA;AACA,QAAA,IAAA,EAAA;AADA,OADA,EAIA,IAJA,CAIA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,GAAA,CAAA,IAAA,CAAA,YAAA,KAAA,CAAA,GAAA,OAAA,GAAA,OAAA,CAAA;AACA,QAAA,QAAA,CAAA,MAAA;AACA,OAPA,EAQA,KARA,CAQA,UAAA,CAAA,EAAA;AAAA,QAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AAAA,OARA;AASA,KAhBA;AAkBA,IAAA,UAlBA,sBAkBA,GAlBA,EAkBA;AACA,WAAA,KAAA,CACA,IADA,CACA,sBADA,EACA;AACA,QAAA,IAAA,EAAA;AACA,UAAA,gBAAA,EAAA,GADA;AAEA,UAAA,QAAA,EAAA,KAAA;AAFA;AADA,OADA,EAOA,IAPA,CAOA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,OAAA,CAAA;AACA,QAAA,QAAA,CAAA,MAAA;AACA,OAVA,EAWA,KAXA,CAWA,UAAA,CAAA,EAAA;AAAA,QAAA,OAAA,CAAA,GAAA,CAAA,CAAA;AAAA,OAXA;AAYA;AA/BA,GA/DA;AAiGA,EAAA,KAAA,EAAA;AACA,IAAA,MAAA,EAAA;AACA,MAAA,OADA,qBACA;AACA,QAAA,QAAA,CAAA,MAAA;AACA;AAHA;AADA;AAjGA,CAAA","sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <h3 class=\"text-center\">{{ branch }}</h3>\r\n        <div class=\"card p-4 border mt-5\">\r\n            <h3>館內書籍一覽</h3>\r\n            <table class=\"table mt-3\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\">#</th>\r\n                        <th scope=\"col\">書名</th>\r\n                        <th scope=\"col\">條碼號</th>\r\n                        <th scope=\"col\">索書號</th>\r\n                        <th scope=\"col\">狀態</th>\r\n                        <th scope=\"col\"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(b, index) in Copys\" :key=\"b.accession_number\" class=\"h-100\">\r\n                        <td>{{ index + 1 }}</td>\r\n                        <td><router-link :to=\" '/book/' + b.ISBN \">{{ b.name }}</router-link></td>\r\n                        <td>{{ b.accession_number }}</td>\r\n                        <td>{{ b.call_number }}</td>\r\n                        <td>{{ MapCodeToState(b.state) === '' ? \"借出中\" : MapCodeToState(b.state)}}</td>\r\n                        <td>\r\n                            <button v-if=\"b.state === 0\" @click=\"HandleBorrow(b.accession_number, branch)\" class=\"btn btn-danger\">借閱</button>\r\n                            <button v-else class=\"btn btn-second\" disabled>已借閱</button>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div class=\"card p-4 border mt-5\">\r\n            <h3>所有外借書詳情</h3>\r\n            <table class=\"table mt-3\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\">#</th>\r\n                        <th scope=\"col\">書名</th>\r\n                        <th scope=\"col\">條碼號</th>\r\n                        <th scope=\"col\">借閱日期</th>\r\n                        <th scope=\"col\"></th>\r\n                        <th scope=\"col\"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(b, index) in Borrowing\" :key=\"b.accession_number\" class=\"h-100\">\r\n                        <td>{{ index + 1 }}</td>\r\n                        <td><router-link :to=\" '/book/' + b.ISBN \">{{ b.name }}</router-link></td>\r\n                        <td>{{ b.accession_number }}</td>\r\n                        <td>{{ ParseDate(b.borrow_date) }}</td>\r\n                        <td><button @click=\"HandleBackCopy(b)\" class=\"btn btn-danger\">歸還</button></td>\r\n                        <td><button @click=\"HandleBackCopy(b)\" class=\"btn btn-danger\">查看預約情形</button></td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div class=\"card p-4 border mt-5\">\r\n            <h3>正在移轉 <mark>進</mark> 的館藏</h3>\r\n            <table class=\"table mt-3\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\">#</th>\r\n                        <th scope=\"col\">書名</th>\r\n                        <th scope=\"col\">條碼號</th>\r\n                        <th scope=\"col\">移轉日期</th>\r\n                        <th scope=\"col\"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(b, index) in Span_in\" :key=\"b.accession_number\" class=\"h-100\">\r\n                        <td>{{ index + 1 }}</td>\r\n                        <td><router-link :to=\" '/book/' + b.ISBN \">{{ b.name }}</router-link></td>\r\n                        <td>{{ b.accession_number }}</td>\r\n                        <td>{{ ParseDate(b.date) }}</td>\r\n                        <td><button @click=\"HandleSpan(b.accession_number)\" class=\"btn btn-danger\">登記進館</button></td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n\r\n\r\n\r\n        <div class=\"jumpFrame row justify-content-center align-items-center\" v-if=\" branch === '' \">\r\n            <div class=\"card col-6 p-5\" @click.stop>\r\n                <h3>您所在的分館是？</h3>\r\n                <hr>\r\n                <form>\r\n                    <div class=\"form-group form-row\">\r\n                        <label for=\"address col\" class=\"col-sm-2 col-form-label\">分館</label>\r\n                        <select class=\"form-control col\" v-model=\"sel_branch\" id=\"address\">\r\n                            <option v-for=\"(b) in branchs\" :key=\"b.branch_name\">{{ b.branch_name }}</option>\r\n                        </select>\r\n                    </div>\r\n                </form>\r\n                <button class=\"btn btn-primary mt-5\" @click=\"SetBranch(sel_branch)\">確定</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            Copys: [],\r\n            Borrowing: [],\r\n            Span_in: [],\r\n            Span_out: [],\r\n            sel_branch: '',\r\n            branch: sessionStorage.getItem('Branch') || \"\"\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.$http\r\n            .post('/api/searchBook/getBorrowingByBranch', {\r\n                data: {\r\n                    branch: this.branch\r\n                }\r\n            })\r\n            .then(res => {\r\n                this.Borrowing = res.data\r\n            })\r\n            .catch(e => { console.log(e) })\r\n\r\n        this.$http\r\n            .post('/api/location/getInTransferByBranch', {\r\n                data: {\r\n                    branch: this.branch\r\n                }\r\n            })\r\n            .then(res => {\r\n                this.Span_in = res.data\r\n                console.log(res.data)\r\n            })\r\n            .catch(e => { console.log(e) })\r\n\r\n        this.$http\r\n            .post('/api/location/getOutTransferByBranch', {\r\n                data: {\r\n                    branch: this.branch\r\n                }\r\n            })\r\n            .then(res => {\r\n                this.Span_out = res.data\r\n                console.log(res.data)\r\n            })\r\n            .catch(e => { console.log(e) })\r\n        \r\n\r\n        // Get first & second nav selection information\r\n        this.$http\r\n            .post('/api/searchBook/getAllCopyByBranch', { \r\n                data: {\r\n                    location: this.branch \r\n                }\r\n            })\r\n            .then(copys => {\r\n                this.Copys = copys.data\r\n                console.log(\"DADADA\", copys.data)\r\n            })\r\n            .catch(e => { console.log(e) })\r\n    },\r\n\r\n    methods: {\r\n        SetBranch(b) {\r\n            sessionStorage.setItem('Branch', b)\r\n            this.branch = b\r\n        },\r\n\r\n        HandleBackCopy(CopyInfo) {\r\n            this.$http\r\n                .post('/api/searchBook/backCopyByAccession', { \r\n                    data: CopyInfo\r\n                })\r\n                .then(res => {\r\n                    alert(res.data.affectedRows === 0 ? \"歸還失敗!\" : \"歸還成功!\")\r\n                    location.reload()\r\n                })\r\n                .catch(e => { console.log(e) })\r\n        },\r\n\r\n        HandleSpan(acc) {\r\n            this.$http\r\n                .post('/api/searchBook/span', { \r\n                    data: {\r\n                        accession_number: acc,\r\n                        location: this.branch\r\n                    }\r\n                })\r\n                .then(res => {\r\n                    alert(\"移轉成功！\")\r\n                    location.reload()\r\n                })\r\n                .catch(e => { console.log(e) })\r\n        },\r\n    },\r\n\r\n    watch: {\r\n        branch: {\r\n            handler() {\r\n                location.reload()\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"],"sourceRoot":"src/views"}]}