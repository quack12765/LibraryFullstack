{"remainingRequest":"/home/user_2200475/library_PROJ/source/front-end/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/user_2200475/library_PROJ/source/front-end/src/views/BookDetail.vue?vue&type=style&index=0&id=2249fd58&lang=scss&scoped=true&","dependencies":[{"path":"/home/user_2200475/library_PROJ/source/front-end/src/views/BookDetail.vue","mtime":1658131974969},{"path":"/home/user_2200475/library_PROJ/source/front-end/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/user_2200475/library_PROJ/source/front-end/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/user_2200475/library_PROJ/source/front-end/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/user_2200475/library_PROJ/source/front-end/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/user_2200475/library_PROJ/source/front-end/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/user_2200475/library_PROJ/source/front-end/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLkhpZGUgewogICAgZGlzcGxheTogbm9uZTsKfQo="},{"version":3,"sources":["BookDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyJA;AACA;AACA","file":"BookDetail.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div>\n        <div class=\"container\">\n            <div class=\"row\">\n                <div class=\"col-12\">\n                    <div class=\"card p-4\">\n                        <div class=\"row justify-content-around\">\n                            <div class=\"col-3 mr-5\">\n                                <img :src=\"Book.show_img_url\">\n                            </div>\n                            <div class=\"col-6\">\n                                <div class=\"card-body\">\n                                    <h3>{{Book.name}}</h3>\n                                    <hr>\n                                    <p>作者： {{ Book.author }}</p>\n                                    <p>出版社： {{ Book.publisher }}</p>\n                                    <p>出版年分: {{ Book.publish_year }}</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"container\">\n            <ul class=\"nav nav-tabs\">\n                <li class=\"nav-item\">\n                    <a class=\"nav-link \" :class=\"{ active: sel_nav == 0 }\" @click=\" sel_nav = 0 \">館藏</a>\n                </li>\n                <li class=\"nav-item\">\n                    <a class=\"nav-link\" :class=\"{ active: sel_nav == 1 }\" @click=\" sel_nav = 1 \">更多資訊</a>\n                </li>\n                <li class=\"nav-item\">\n                    <a class=\"nav-link\" :class=\"{ active: sel_nav == 2 }\" @click=\" sel_nav = 2 \">評價</a>\n                </li>\n            </ul>\n            <table v-if=\"sel_nav == 0\" class=\"table\">\n                <thead>\n                    <tr>\n                        <th scope=\"col\">條碼號</th>\n                        <th scope=\"col\">索書號</th>\n                        <th scope=\"col\">館藏狀態</th>\n                        <th scope=\"col\">預約人數</th>\n                        <th scope=\"col\"></th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr v-for=\"copy in Copys\" :key=\"copy.accession_number\">\n                        <td>{{ copy.accession_number }}</td>\n                        <td>{{ copy.call_number }}</td>\n                        <td>{{ copy.account === null ? \"可借閱\" : \"借出中 \" }}</td>\n                        <td>{{ copy.account === null ? 0 : getCopyReservationByAccession(copy.accession_number) }}</td>\n                        <td>\n                            <button v-if=\"!copy.account\" @click=\"HandleBorrow(copy.accession_number)\" class=\"btn btn-success\">借閱</button>\n                            <button v-if=\"copy.account\" @click=\"HandleReserve(copy.accession_number)\" class=\"btn btn-primary\">預約</button>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n            <div v-if=\"sel_nav == 1\">\n                <p> {{ Book.intro }} </p>\n            </div>\n        </div>\n    </div>\n</template>\n\n\n<script>\nexport default {\n    inject: [\"reload\"],\n\n    data() {\n        return {\n            Book: {},\n            Copys: [],\n            sel_nav: 0,\n        };\n    },\n\n    mounted() {\n        this.$http\n            .post('/api/searchBook/getBookInfoByISBN', { data: this.$route.params.ISBN })\n            .then(res => {\n                this.Book = res.data[0]\n            })\n            .catch(e => { console.log(e) })\n\n        this.$http\n            .post('/api/searchBook/getCopyInfoByISBN', { data: this.$route.params.ISBN })\n            .then(res => {\n                this.Copys = res.data\n                console.log(res.data)\n            })\n            .catch(e => { console.log(e) })\n\n    },\n\n    update() {\n        \n    },\n\n    methods: {\n        getCopyReservationByAccession(acc){\n            this.$http\n                .post('/api/searchBook/getCopyReservationByAccession', { data: acc })\n                .then(res => {\n                    console.log(res.data.length)\n                })\n                .catch(e => { console.log(e) })\n            \n            return 1\n        },\n\n        HandleBorrow(acc) {\n            this.$http\n                .post('/api/searchBook/borrowCopy', { \n                    data: {\n                        accession_number: acc,\n                        account: sessionStorage.getItem(\"ACCOUNT\")\n                    } \n                })\n                .then(res => {\n                    alert(\"借閱成功!\")\n                    location.reload()\n                })\n                .catch(e => { \n                    alert(\"借閱失敗\")\n                    console.log(e) \n                })\n        },\n\n        HandleReserve(acc) {\n            this.$http\n                .post('/api/searchBook/reserveCopy', { \n                    data: {\n                        accession_number: acc,\n                        account: sessionStorage.getItem(\"ACCOUNT\")\n                    } \n                })\n                .then(res => {\n                    alert(\"預約成功!\")\n                    location.reload()\n                })\n                .catch(e => { \n                    alert(\"預約失敗\")\n                    console.log(e) \n                })\n        }\n    },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n    .Hide {\n        display: none;\n    }\n</style>"]}]}