{"remainingRequest":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\src\\views\\AdminMain.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\src\\views\\AdminMain.vue","mtime":1658481437062},{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\library_PROJ\\LibraryFullstack\\source\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgZGF0YSgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIENvcHlzOiBbXSwNCiAgICAgICAgICAgIEJvcnJvd2luZzogW10sDQogICAgICAgICAgICBTcGFuX2luOiBbXSwNCiAgICAgICAgICAgIFNwYW5fb3V0OiBbXSwNCiAgICAgICAgICAgIHNlbF9icmFuY2g6ICcnLA0KICAgICAgICAgICAgYnJhbmNoOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdCcmFuY2gnKSB8fCAiIg0KICAgICAgICB9DQogICAgfSwNCg0KICAgIG1vdW50ZWQoKSB7DQogICAgICAgIHRoaXMuJGh0dHANCiAgICAgICAgICAgIC5wb3N0KCcvYXBpL3NlYXJjaEJvb2svZ2V0Qm9ycm93aW5nQnlCcmFuY2gnLCB7DQogICAgICAgICAgICAgICAgZGF0YTogew0KICAgICAgICAgICAgICAgICAgICBicmFuY2g6IHRoaXMuYnJhbmNoDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICAgICAgdGhpcy5Cb3Jyb3dpbmcgPSByZXMuZGF0YQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaChlID0+IHsgY29uc29sZS5sb2coZSkgfSkNCg0KICAgICAgICB0aGlzLiRodHRwDQogICAgICAgICAgICAucG9zdCgnL2FwaS9sb2NhdGlvbi9nZXRJblRyYW5zZmVyQnlCcmFuY2gnLCB7DQogICAgICAgICAgICAgICAgZGF0YTogew0KICAgICAgICAgICAgICAgICAgICBicmFuY2g6IHRoaXMuYnJhbmNoDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICAgICAgdGhpcy5TcGFuX2luID0gcmVzLmRhdGENCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSkNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICAuY2F0Y2goZSA9PiB7IGNvbnNvbGUubG9nKGUpIH0pDQoNCiAgICAgICAgdGhpcy4kaHR0cA0KICAgICAgICAgICAgLnBvc3QoJy9hcGkvbG9jYXRpb24vZ2V0T3V0VHJhbnNmZXJCeUJyYW5jaCcsIHsNCiAgICAgICAgICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICAgICAgICAgIGJyYW5jaDogdGhpcy5icmFuY2gNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLlNwYW5fb3V0ID0gcmVzLmRhdGENCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMuZGF0YSkNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICAuY2F0Y2goZSA9PiB7IGNvbnNvbGUubG9nKGUpIH0pDQogICAgICAgIA0KDQogICAgICAgIC8vIEdldCBmaXJzdCAmIHNlY29uZCBuYXYgc2VsZWN0aW9uIGluZm9ybWF0aW9uDQogICAgICAgIHRoaXMuJGh0dHANCiAgICAgICAgICAgIC5wb3N0KCcvYXBpL3NlYXJjaEJvb2svZ2V0QWxsQ29weUJ5QnJhbmNoJywgeyANCiAgICAgICAgICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiB0aGlzLmJyYW5jaCANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLnRoZW4oY29weXMgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMuQ29weXMgPSBjb3B5cy5kYXRhDQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkRBREFEQSIsIGNvcHlzLmRhdGEpDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLmNhdGNoKGUgPT4geyBjb25zb2xlLmxvZyhlKSB9KQ0KICAgIH0sDQoNCiAgICBtZXRob2RzOiB7DQogICAgICAgIFNldEJyYW5jaChiKSB7DQogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdCcmFuY2gnLCBiKQ0KICAgICAgICAgICAgdGhpcy5icmFuY2ggPSBiDQogICAgICAgIH0sDQoNCiAgICAgICAgSGFuZGxlQmFja0NvcHkoQ29weUluZm8pIHsNCiAgICAgICAgICAgIHRoaXMuJGh0dHANCiAgICAgICAgICAgICAgICAucG9zdCgnL2FwaS9zZWFyY2hCb29rL2JhY2tDb3B5QnlBY2Nlc3Npb24nLCB7IA0KICAgICAgICAgICAgICAgICAgICBkYXRhOiBDb3B5SW5mbw0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzLmRhdGEuYWZmZWN0ZWRSb3dzID09PSAwID8gIuatuOmChOWkseaVlyEiIDogIuatuOmChOaIkOWKnyEiKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgLmNhdGNoKGUgPT4geyBjb25zb2xlLmxvZyhlKSB9KQ0KICAgICAgICB9LA0KDQogICAgICAgIEhhbmRsZVNwYW4oYWNjKSB7DQogICAgICAgICAgICB0aGlzLiRodHRwDQogICAgICAgICAgICAgICAgLnBvc3QoJy9hcGkvc2VhcmNoQm9vay9zcGFuJywgeyANCiAgICAgICAgICAgICAgICAgICAgZGF0YTogew0KICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXNzaW9uX251bWJlcjogYWNjLA0KICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb246IHRoaXMuYnJhbmNoDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLnp7vovYnmiJDlip/vvIEiKQ0KICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgLmNhdGNoKGUgPT4geyBjb25zb2xlLmxvZyhlKSB9KQ0KICAgICAgICB9LA0KICAgIH0sDQoNCiAgICB3YXRjaDogew0KICAgICAgICBicmFuY2g6IHsNCiAgICAgICAgICAgIGhhbmRsZXIoKSB7DQogICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="},{"version":3,"sources":["AdminMain.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminMain.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <h3 class=\"text-center\">{{ branch }}</h3>\r\n        <div class=\"card p-4 border mt-5\">\r\n            <h3>館內書籍一覽</h3>\r\n            <table class=\"table mt-3\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\">#</th>\r\n                        <th scope=\"col\">書名</th>\r\n                        <th scope=\"col\">條碼號</th>\r\n                        <th scope=\"col\">索書號</th>\r\n                        <th scope=\"col\">狀態</th>\r\n                        <th scope=\"col\"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(b, index) in Copys\" :key=\"b.accession_number\" class=\"h-100\">\r\n                        <td>{{ index + 1 }}</td>\r\n                        <td><router-link :to=\" '/book/' + b.ISBN \">{{ b.name }}</router-link></td>\r\n                        <td>{{ b.accession_number }}</td>\r\n                        <td>{{ b.call_number }}</td>\r\n                        <td>{{ MapCodeToState(b.state) === '' ? \"借出中\" : MapCodeToState(b.state)}}</td>\r\n                        <td>\r\n                            <button v-if=\"b.state === 0\" @click=\"HandleBorrow(b.accession_number, branch)\" class=\"btn btn-danger\">借閱</button>\r\n                            <button v-else class=\"btn btn-second\" disabled>已借閱</button>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div class=\"card p-4 border mt-5\">\r\n            <h3>所有外借書詳情</h3>\r\n            <table class=\"table mt-3\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\">#</th>\r\n                        <th scope=\"col\">書名</th>\r\n                        <th scope=\"col\">條碼號</th>\r\n                        <th scope=\"col\">借閱日期</th>\r\n                        <th scope=\"col\"></th>\r\n                        <th scope=\"col\"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(b, index) in Borrowing\" :key=\"b.accession_number\" class=\"h-100\">\r\n                        <td>{{ index + 1 }}</td>\r\n                        <td><router-link :to=\" '/book/' + b.ISBN \">{{ b.name }}</router-link></td>\r\n                        <td>{{ b.accession_number }}</td>\r\n                        <td>{{ ParseDate(b.borrow_date) }}</td>\r\n                        <td><button @click=\"HandleBackCopy(b)\" class=\"btn btn-danger\">歸還</button></td>\r\n                        <td><button @click=\"HandleBackCopy(b)\" class=\"btn btn-danger\">查看預約情形</button></td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div class=\"card p-4 border mt-5\">\r\n            <h3>正在移轉 <mark>進</mark> 的館藏</h3>\r\n            <table class=\"table mt-3\">\r\n                <thead>\r\n                    <tr>\r\n                        <th scope=\"col\">#</th>\r\n                        <th scope=\"col\">書名</th>\r\n                        <th scope=\"col\">條碼號</th>\r\n                        <th scope=\"col\">移轉日期</th>\r\n                        <th scope=\"col\"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(b, index) in Span_in\" :key=\"b.accession_number\" class=\"h-100\">\r\n                        <td>{{ index + 1 }}</td>\r\n                        <td><router-link :to=\" '/book/' + b.ISBN \">{{ b.name }}</router-link></td>\r\n                        <td>{{ b.accession_number }}</td>\r\n                        <td>{{ ParseDate(b.date) }}</td>\r\n                        <td><button @click=\"HandleSpan(b.accession_number)\" class=\"btn btn-danger\">登記進館</button></td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n\r\n\r\n\r\n        <div class=\"jumpFrame row justify-content-center align-items-center\" v-if=\" branch === '' \">\r\n            <div class=\"card col-6 p-5\" @click.stop>\r\n                <h3>您所在的分館是？</h3>\r\n                <hr>\r\n                <form>\r\n                    <div class=\"form-group form-row\">\r\n                        <label for=\"address col\" class=\"col-sm-2 col-form-label\">分館</label>\r\n                        <select class=\"form-control col\" v-model=\"sel_branch\" id=\"address\">\r\n                            <option v-for=\"(b) in branchs\" :key=\"b.branch_name\">{{ b.branch_name }}</option>\r\n                        </select>\r\n                    </div>\r\n                </form>\r\n                <button class=\"btn btn-primary mt-5\" @click=\"SetBranch(sel_branch)\">確定</button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data() {\r\n        return {\r\n            Copys: [],\r\n            Borrowing: [],\r\n            Span_in: [],\r\n            Span_out: [],\r\n            sel_branch: '',\r\n            branch: sessionStorage.getItem('Branch') || \"\"\r\n        }\r\n    },\r\n\r\n    mounted() {\r\n        this.$http\r\n            .post('/api/searchBook/getBorrowingByBranch', {\r\n                data: {\r\n                    branch: this.branch\r\n                }\r\n            })\r\n            .then(res => {\r\n                this.Borrowing = res.data\r\n            })\r\n            .catch(e => { console.log(e) })\r\n\r\n        this.$http\r\n            .post('/api/location/getInTransferByBranch', {\r\n                data: {\r\n                    branch: this.branch\r\n                }\r\n            })\r\n            .then(res => {\r\n                this.Span_in = res.data\r\n                console.log(res.data)\r\n            })\r\n            .catch(e => { console.log(e) })\r\n\r\n        this.$http\r\n            .post('/api/location/getOutTransferByBranch', {\r\n                data: {\r\n                    branch: this.branch\r\n                }\r\n            })\r\n            .then(res => {\r\n                this.Span_out = res.data\r\n                console.log(res.data)\r\n            })\r\n            .catch(e => { console.log(e) })\r\n        \r\n\r\n        // Get first & second nav selection information\r\n        this.$http\r\n            .post('/api/searchBook/getAllCopyByBranch', { \r\n                data: {\r\n                    location: this.branch \r\n                }\r\n            })\r\n            .then(copys => {\r\n                this.Copys = copys.data\r\n                console.log(\"DADADA\", copys.data)\r\n            })\r\n            .catch(e => { console.log(e) })\r\n    },\r\n\r\n    methods: {\r\n        SetBranch(b) {\r\n            sessionStorage.setItem('Branch', b)\r\n            this.branch = b\r\n        },\r\n\r\n        HandleBackCopy(CopyInfo) {\r\n            this.$http\r\n                .post('/api/searchBook/backCopyByAccession', { \r\n                    data: CopyInfo\r\n                })\r\n                .then(res => {\r\n                    alert(res.data.affectedRows === 0 ? \"歸還失敗!\" : \"歸還成功!\")\r\n                    location.reload()\r\n                })\r\n                .catch(e => { console.log(e) })\r\n        },\r\n\r\n        HandleSpan(acc) {\r\n            this.$http\r\n                .post('/api/searchBook/span', { \r\n                    data: {\r\n                        accession_number: acc,\r\n                        location: this.branch\r\n                    }\r\n                })\r\n                .then(res => {\r\n                    alert(\"移轉成功！\")\r\n                    location.reload()\r\n                })\r\n                .catch(e => { console.log(e) })\r\n        },\r\n    },\r\n\r\n    watch: {\r\n        branch: {\r\n            handler() {\r\n                location.reload()\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"]}]}